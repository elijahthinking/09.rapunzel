
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¼í‘¼ì ¤ í€´ì¦ˆí’€ì´</title>
    
</head>
<body>

<div class="quiz-container">
    
    <div id="quiz-game-screen">
        <div class="header">
            <span class="back-arrow" onclick="location.reload()">â†º ì¹´í…Œê³ ë¦¬ ì„ íƒ</span>
            <span class="progress-bar-container">
                <div id="progressBar" class="progress-bar"></div>
            </span>
            <span id="pageNumber" class="page-number">0/0</span>
        </div>

        <div class="score-display">
            í˜„ì¬ ì ìˆ˜: <span id="currentScore">0</span>ì 
        </div>

        <div class="question-area">
            <p class="quiz-title" id="quizTitle">ë¼í‘¼ì ¤ í€´ì¦ˆ: <span id="currentCategoryTitle"></span></p>
            <p class="question-text" id="questionText">ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>

        <div class="choices-area" id="choicesArea">
            </div>
    </div>

    <div id="quiz-start-screen" class="control-screen">
        <!-- ë¼í‘¼ì ¤ì•„ì´ì½˜ -->
        <img src="https://wrtn-image-user-output.s3.ap-northeast-2.amazonaws.com/gen-image/68ad43d95bebe691666b9b2e/ff480741-312c-46ab-bad5-b972d8701f5e.png" alt="Rapunzel Quiz" style="width:120px; height:auto; margin-bottom:10px;">
        <h1>ğŸ‘¸<span> ë¼í‘¼ì ¤ í€´ì¦ˆ</span></h1>
        <p>í’€ê³  ì‹¶ì€ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.</p>
        <div class="category-grid" id="categoryArea">
            </div>
    </div>
    
    <div id="quiz-result-screen" class="control-screen" style="display:none;">
        <h2 id="resultTitle"></h2>
        <p id="finalScoreText"></p>
        <p id="resultScore"></p>
        <p id="resultMessage"></p>
        <button onclick="location.reload()">ìƒˆë¡œìš´ í€´ì¦ˆ ì‹œì‘í•˜ê¸°</button>
    </div>

</div>

<script>
    // JavaScript ì½”ë“œ ì‹œì‘
    
    const QUIZ_DATA = {
        "í…ŒìŠ¤íŠ¸ ì´ë¦„": "ë¼í‘¼ì ¤ í€´ì¦ˆ",
        "categories": [
            { name: "ë¼í‘¼ì ¤ ì£¼ìš” ì¸ë¬¼ ë° ì„¤ì •", theme: "a" },
            { name: "ë§ˆë²•ì˜ í˜ê³¼ ìš”ì†Œ", theme: "b" },
            { name: "í”Œë¦° ë¼ì´ë”ì™€ ì—¬ì •", theme: "c" },
            { name: "í›„ë°˜ë¶€ì™€ ì£¼ì œ", theme: "d" }
        ],
        "quizzes": [
            { "id": 1, "category": "ë¼í‘¼ì ¤ ì£¼ìš” ì¸ë¬¼ ë° ì„¤ì •", "question": "ë¼í‘¼ì ¤ì˜ ìƒì§•ì ì¸ ê¸´ ë¨¸ë¦¬ì¹´ë½ì˜ ì´ ê¸¸ì´ëŠ” ëª‡ í”¼íŠ¸(feet)ë¡œ ì•Œë ¤ì ¸ ìˆë‚˜ìš”?", "choices": ["20í”¼íŠ¸", "50í”¼íŠ¸", "70í”¼íŠ¸", "100í”¼íŠ¸"], "correct": 3 },
            { "id": 2, "category": "ë¼í‘¼ì ¤ ì£¼ìš” ì¸ë¬¼ ë° ì„¤ì •", "question": "ë¼í‘¼ì ¤ì„ ë‚©ì¹˜í•˜ì—¬ ìì‹ ì˜ ë”¸ì²˜ëŸ¼ í‚¤ìš´ ë¹ŒëŸ°ì˜ ì´ë¦„ì€?", "choices": ["ê³ ë¸", "ë©œë¡œë””", "ì´ì‹œë„ë¼", "ë‚˜íƒˆë¦¬"], "correct": 1 },
            { "id": 3, "category": "ë¼í‘¼ì ¤ ì£¼ìš” ì¸ë¬¼ ë° ì„¤ì •", "question": "ë¼í‘¼ì ¤ì˜ ë°˜ë ¤ë™ë¬¼ì´ì, ê·¸ë…€ì˜ ê°ì •ì„ ì˜ í‘œí˜„í•´ì£¼ëŠ” ì¹´ë©œë ˆì˜¨ì˜ ì´ë¦„ì€?", "choices": ["íŒŒìŠ¤ì¹¼", "ë§‰ì‹œë¬´ìŠ¤", "í”¼ë‹‰ìŠ¤", "ìœ ì§„"], "correct": 1 },
            { "id": 4, "category": "ë¼í‘¼ì ¤ ì£¼ìš” ì¸ë¬¼ ë° ì„¤ì •", "question": "ë¼í‘¼ì ¤ì˜ ë¨¸ë¦¬ë¥¼ ìë¥´ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ì¹¼ì„ í›”ì¹˜ë ¤ í–ˆë˜ ë„ë‘‘ì˜ ì´ë¦„ì€?", "choices": ["ìœ ì§„", "ì¹´ì‚°ë“œë¼", "ì‡¼íŠ¸", "ìŠ¤íƒœë¹™í†¤ í˜•ì œ"], "correct": 4 },
            { "id": 5, "category": "ë¼í‘¼ì ¤ ì£¼ìš” ì¸ë¬¼ ë° ì„¤ì •", "question": "ë¼í‘¼ì ¤ì´ íƒ‘ì„ ë‚´ë ¤ì˜¤ì§€ ì•Šê³  ë¨¸ë¬¼ë €ë˜ ê¸°ê°„ì€ ëŒ€ëµ ëª‡ ë…„ì¸ê°€ìš”?", "choices": ["10ë…„", "18ë…„", "20ë…„", "25ë…„"], "correct": 2 },
            { "id": 6, "category": "ë§ˆë²•ì˜ í˜ê³¼ ìš”ì†Œ", "question": "ë¼í‘¼ì ¤ì˜ ë¨¸ë¦¬ì¹´ë½ì´ ë§ˆë²•ì˜ í˜ì„ ë°œíœ˜í•  ë•Œ ë‚´ëŠ” ë¹›ê¹”ì€?", "choices": ["ë³´ë¼ìƒ‰", "ì€ìƒ‰", "í™©ê¸ˆë¹›", "ë¬´ì§€ê°œìƒ‰"], "correct": 3 },
            { "id": 7, "category": "ë§ˆë²•ì˜ í˜ê³¼ ìš”ì†Œ", "question": "ë¼í‘¼ì ¤ì˜ ë¨¸ë¦¬ì¹´ë½ì´ ë§ˆë²•ì ì¸ ëŠ¥ë ¥ì„ ìƒê²Œ ë˜ëŠ” ìœ ì¼í•œ ì¡°ê±´ì€ ë¬´ì—‡ì¸ê°€ìš”?", "choices": ["ì –ì„ ë•Œ", "ì–´ë‘  ì†ì— ìˆì„ ë•Œ", "ìë„ ë•Œ", "ì˜ë¦´ ë•Œ"], "correct": 4 },
            { "id": 8, "category": "ë§ˆë²•ì˜ í˜ê³¼ ìš”ì†Œ", "question": "ë¼í‘¼ì ¤ì´ ë¶€ë¥´ëŠ” ë§ˆë²• ë…¸ë˜ì˜ ì£¼ëœ í˜ì€ ë¬´ì—‡ì¸ê°€ìš”?", "choices": ["ì‹œê°„ì„ ë©ˆì¶”ëŠ” ê²ƒ", "ëª¸ì„ ì¹˜ìœ í•˜ê³  ì ŠìŒì„ ìœ ì§€í•˜ëŠ” ê²ƒ", "ë¬¼ê±´ì„ ì›€ì§ì´ëŠ” ê²ƒ", "ë‚ ì”¨ë¥¼ ì¡°ì¢…í•˜ëŠ” ê²ƒ"], "correct": 2 },
            { "id": 9, "category": "ë§ˆë²•ì˜ í˜ê³¼ ìš”ì†Œ", "question": "ë¼í‘¼ì ¤ì˜ ë¨¸ë¦¬ì¹´ë½ì€ ì›ë˜ ë¬´ì—‡ì—ì„œ ìœ ë˜í•œ í˜ì¸ê°€ìš”?", "choices": ["ë§ˆë…€ ê³ ë¸ì˜ ì €ì£¼", "íƒ€ë¥´ê°€ë¥´ì˜Œ ê°€ë¬¸ì˜ ìœ ì‚°", "í•˜ëŠ˜ì—ì„œ ë–¨ì–´ì§„ ë§ˆë²•ì˜ ê½ƒ", "ì‹ ë¹„ë¡œìš´ í˜¸ìˆ˜"], "correct": 3 },
            { "id": 10, "category": "ë§ˆë²•ì˜ í˜ê³¼ ìš”ì†Œ", "question": "ë¼í‘¼ì ¤ì˜ ë¨¸ë¦¬ì¹´ë½ì´ ì˜ë¦° í›„, ê·¸ë…€ì˜ ë¨¸ë¦¬ì¹´ë½ ìƒ‰ê¹”ì€ ì–´ë–»ê²Œ ë³€í•˜ë‚˜ìš”?", "choices": ["ê°ˆìƒ‰", "ê¸ˆìƒ‰", "ê²€ì€ìƒ‰", "í°ìƒ‰"], "correct": 1 },
            { "id": 11, "category": "í”Œë¦° ë¼ì´ë”ì™€ ì—¬ì •", "question": "í”Œë¦° ë¼ì´ë”ê°€ ì™•ì‹¤ì—ì„œ í›”ì¹œ ë¬¼ê±´ì€ ë¬´ì—‡ì¸ê°€ìš”?", "choices": ["ë³´ì„ì´ ë°•íŒ ê²€", "ì™•ì‹¤ì˜ ì™•ê´€", "ë§ˆë²•ì˜ ê±°ìš¸", "ì–´ë¨¸ë‹ˆì˜ ìœ í’ˆ"], "correct": 2 },
            { "id": 12, "category": "í”Œë¦° ë¼ì´ë”ì™€ ì—¬ì •", "question": "í”Œë¦° ë¼ì´ë”ê°€ ë³¸ëª… ëŒ€ì‹  'í”Œë¦° ë¼ì´ë”'ë¼ëŠ” ì´ë¦„ì„ ì‚¬ìš©í•˜ê²Œ ëœ ë™ê¸°ëŠ”?", "choices": ["ì›ë˜ ì´ë¦„ì´ ë„ˆë¬´ í”í•´ì„œ", "ì–´ë¦´ ë•Œ ì½ì€ ëª¨í—˜ ì†Œì„¤ ì† ì£¼ì¸ê³µ ì´ë¦„ì´ì–´ì„œ", "ì™•ê¶ì— ìˆ¨ì–´ë“¤ê¸° ìœ„í•´ì„œ", "ê³ ë¸ì—ê²Œì„œ ìˆ¨ê¸° ìœ„í•´ì„œ"], "correct": 2 },
            { "id": 13, "category": "í”Œë¦° ë¼ì´ë”ì™€ ì—¬ì •", "question": "ë¼í‘¼ì ¤ì´ íƒ‘ì„ ë²—ì–´ë‚˜ í”Œë¦°ê³¼ í•¨ê»˜ ê°€ê³ ì í–ˆë˜ ìµœì¢… ëª©ì ì§€ëŠ”?", "choices": ["ë°”ë‹·ê°€", "ê¶ì „", "ë– ì˜¤ë¥´ëŠ” ë¶ˆë¹›(ëœí„´)ì„ ë³´ëŠ” ê³³", "ë„ì„œê´€"], "correct": 3 },
            { "id": 14, "category": "í”Œë¦° ë¼ì´ë”ì™€ ì—¬ì •", "question": "í”Œë¦° ë¼ì´ë”ì˜ ë³¸ëª…ì€ ë¬´ì—‡ì¸ê°€ìš”?", "choices": ["ìœ ì§„ í”¼ì¸ í—ˆë²„íŠ¸", "ë§ˆì´í´ ë¼ì´ë”", "ì­ìŠ¨ í”Œë¦°", "ì•„ë” í”¼ì¸ "], "correct": 1 },
            { "id": 15, "category": "í”Œë¦° ë¼ì´ë”ì™€ ì—¬ì •", "question": "ë¼í‘¼ì ¤ê³¼ í”Œë¦°ì´ ì—¬ì • ì¤‘ ë“¤ëŸ¬ì„œ ë¬´ì„œìš´ ì™¸ëª¨ì™€ ë‹¬ë¦¬ ë”°ëœ»í•œ ë§ˆìŒì„ ê°€ì§„ ì‚¬ëŒë“¤ì„ ë§Œë‚œ ìˆ ì§‘ ì´ë¦„ì€?", "choices": ["ê°€ì‹œë¤ë¶ˆ", "ê³ ë¸ì˜ ì€ì‹ ì²˜", "ê·€ì—¬ìš´ ì˜¤ë¦¬ ì£¼ì  (Snuggly Duckling)", "í•´ì ì˜ ë§Œ"], "correct": 3 },
            { "id": 16, "category": "í›„ë°˜ë¶€ì™€ ì£¼ì œ", "question": "ë¼í‘¼ì ¤ì´ ìì‹ ì˜ ì§„ì§œ ë¶€ëª¨ë‹˜ì„ ì•Œì•„ë³´ëŠ” ê²°ì •ì ì¸ ë‹¨ì„œëŠ”?", "choices": ["ì–´ë¦´ ë•Œ ì‚¬ì§„", "ë¨¸ë¦¬ì¹´ë½ ìƒ‰ê¹”", "ì–´ë¨¸ë‹ˆì˜ ëª©ì†Œë¦¬", "ë²½ì— ê·¸ë¦° ê·¸ë¦¼"], "correct": 4 },
            { "id": 17, "category": "í›„ë°˜ë¶€ì™€ ì£¼ì œ", "question": "ì™•êµ­ì˜ ëª¨ë“  ì‚¬ëŒë“¤ì´ ë§¤ë…„ ë¼í‘¼ì ¤ì˜ ìƒì¼ë§ˆë‹¤ í•˜ëŠ˜ë¡œ ë„ìš°ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?", "choices": ["ì¢…ì´ë°°", "í’ì„ ", "í’ë“± (ëœí„´)", "ë¶ˆê½ƒë†€ì´"], "correct": 3 },
            { "id": 18, "category": "í›„ë°˜ë¶€ì™€ ì£¼ì œ", "question": "ë§ˆë…€ ê³ ë¸ì˜ ì§„ì •í•œ ëª©í‘œëŠ” ë¬´ì—‡ì´ì—ˆë‚˜ìš”?", "choices": ["ì™•êµ­ì˜ ì¬ì‚°ì„ í›”ì¹˜ëŠ” ê²ƒ", "ë¼í‘¼ì ¤ì„ ìì‹ ì˜ ë”¸ë¡œ ë§Œë“œëŠ” ê²ƒ", "ë¼í‘¼ì ¤ì˜ ë§ˆë²•ìœ¼ë¡œ ì˜ì›í•œ ì ŠìŒì„ ìœ ì§€í•˜ëŠ” ê²ƒ", "ì™•êµ­ì„ ì •ë³µí•˜ëŠ” ê²ƒ"], "correct": 3 },
            { "id": 19, "category": "í›„ë°˜ë¶€ì™€ ì£¼ì œ", "question": "í”Œë¦° ë¼ì´ë”ê°€ ë¼í‘¼ì ¤ì˜ ë¨¸ë¦¬ì¹´ë½ì„ ìë¥¸ ì´ìœ ëŠ”?", "choices": ["ë¼í‘¼ì ¤ì´ ì›í•´ì„œ", "ê³ ë¸ì„ ëŠ™ì–´ ì£½ê²Œ ë§Œë“¤ì–´ì„œ", "ê³ ë¸ë¡œë¶€í„° ë¼í‘¼ì ¤ì„ ììœ ë¡­ê²Œ í•˜ê¸° ìœ„í•´ì„œ", "ë” ì´ìƒ ë¨¸ë¦¬ì¹´ë½ì„ ì›í•˜ì§€ ì•Šì•„ì„œ"], "correct": 3 },
            { "id": 20, "category": "í›„ë°˜ë¶€ì™€ ì£¼ì œ", "question": "ë¼í‘¼ì ¤ì˜ ë§ˆë²• ë…¸ë˜ê°€ ì•„ë‹Œ, ì¹˜ìœ ì˜ í˜ì„ ë°œíœ˜í•˜ëŠ” ë§ˆì§€ë§‰ ìˆ˜ë‹¨ì€ ë¬´ì—‡ì´ì—ˆë‚˜ìš”?", "choices": ["ëˆˆë¬¼", "í‚¤ìŠ¤", "ê¸°ì ", "ë§ˆë²•ì˜ ê½ƒ"], "correct": 1 }
        ]
    };

    let currentQuestionIndex = 0;
    let totalQuestions = 0;
    let currentQuizData = []; 
    let score = 0; 
    const POINTS_PER_QUESTION = 20; 
    let activeTheme = { 
        main: '#3498db', 
        bg: '#e8f5ff',
        border: '#3498db'
    };
    
    // DOM ìš”ì†Œ ìºì‹±
    const startScreen = document.getElementById('quiz-start-screen');
    const gameScreen = document.getElementById('quiz-game-screen');
    const resultScreen = document.getElementById('quiz-result-screen');
    const categoryArea = document.getElementById('categoryArea');
    const choicesArea = document.getElementById('choicesArea');
    const questionTextElement = document.getElementById('questionText');
    const pageNumberElement = document.getElementById('pageNumber');
    const progressBar = document.getElementById('progressBar');
    const currentCategoryTitle = document.getElementById('currentCategoryTitle');
    const finalScoreText = document.getElementById('finalScoreText');
    const currentScoreElement = document.getElementById('currentScore');
    
    // [ID: ì„ íƒí•œ ë‹µ ì¸ë±ìŠ¤] í˜•ì‹ìœ¼ë¡œ ì €ì¥
    const userAnswers = {};
    
    // í…Œë§ˆ ë§¤í•‘ í•¨ìˆ˜
    function getThemeColors(themeId) {
        switch(themeId) {
            case 'a': return { main: '#3498db', bg: '#e8f5ff', border: '#3498db', shadowRgb: '52, 152, 219' }; // ì²­ë¡
            case 'b': return { main: '#9b59b6', bg: '#f5eef9', border: '#9b59b6', shadowRgb: '155, 89, 182' }; // ë³´ë¼
            case 'c': return { main: '#e67e22', bg: '#fef4e8', border: '#e67e22', shadowRgb: '230, 126, 34' }; // ì£¼í™©
            case 'd': return { main: '#2ecc71', bg: '#e6faed', border: '#2ecc71', shadowRgb: '46, 204, 113' }; // ì—°ë‘
            default: return { main: '#3498db', bg: '#e8f5ff', border: '#3498db', shadowRgb: '52, 152, 219' };
        }
    }

    // CSS ë³€ìˆ˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (í€´ì¦ˆ í™”ë©´ ìŠ¤íƒ€ì¼ ë³€ê²½)
    function applyThemeToQuizScreen(themeId) {
        activeTheme = getThemeColors(themeId);
        const root = document.documentElement.style;
        root.setProperty('--color-progress', activeTheme.main);
        root.setProperty('--color-active-bg', activeTheme.bg);
        root.setProperty('--color-active-border', activeTheme.border);
        // (ì°¸ê³ : CSS ë³€ìˆ˜ì— RGB ê°’ ì§ì ‘ ì„¤ì •ì€ ê¹Œë‹¤ë¡œì›Œì„œ shadowRgbëŠ” JSì—ì„œ ì§ì ‘ í™œìš©í•˜ëŠ” ê²ƒì´ ë” ê°„í¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ë°°ê²½ìƒ‰ê³¼ í…Œë‘ë¦¬ë§Œ ë³€ê²½í•´ë„ ì¶©ë¶„íˆ í…Œë§ˆê°€ ì ìš©ë©ë‹ˆë‹¤.)
    }


    // --- í™”ë©´ ì œì–´ í•¨ìˆ˜ ---
    function showScreen(screenId) {
        startScreen.style.display = 'none';
        gameScreen.style.display = 'none';
        resultScreen.style.display = 'none';

        if (screenId === 'start') {
            startScreen.style.display = 'block';
        } else if (screenId === 'game') {
            gameScreen.style.display = 'block';
        } else if (screenId === 'result') {
            gameScreen.style.display = 'none';
            resultScreen.style.display = 'block';
        }
    }

    // --- ì¹´í…Œê³ ë¦¬ ì„ íƒ í™”ë©´ ë Œë”ë§ ---
    function renderCategorySelection() {
        categoryArea.innerHTML = '';
        
        QUIZ_DATA.categories.forEach((category, index) => {
            const card = document.createElement('div');
            card.className = 'category-card';
            
            // CSSì˜ nth-childë¥¼ ìœ„í•´ data-theme ëŒ€ì‹  indexë¥¼ í™œìš©í•˜ê±°ë‚˜, classë¥¼ ì§ì ‘ ì§€ì • ê°€ëŠ¥ (ì—¬ê¸°ì„œëŠ” nth-childê°€ ì ìš©ë˜ë„ë¡ HTML êµ¬ì¡°ë¥¼ ë‹¨ìˆœí™”)
            
            const categoryName = category.name;
            const themeId = category.theme;

            const count = QUIZ_DATA.quizzes.filter(q => q.category === categoryName).length;
            const description = getCategoryDescription(categoryName);
            
            card.innerHTML = `
                <p class="type-main">${categoryName}</p>
                <p class="type-desc">${description} (${count}ë¬¸ì œ)</p>
            `;
            card.addEventListener('click', () => startQuiz(categoryName, themeId));
            categoryArea.appendChild(card);
        });
        showScreen('start');
    }
    
    function getCategoryDescription(categoryName) {
        const descriptions = {
            "ë¼í‘¼ì ¤ ì£¼ìš” ì¸ë¬¼ ë° ì„¤ì •": "ì£¼ì¸ê³µ, ì£¼ë³€ ì¸ë¬¼, íƒ‘ ì† ìƒí™œ, ì˜í™” ì´ˆë°˜ë¶€ì˜ ì£¼ìš” ë°°ê²½ ì„¤ì •",
            "ë§ˆë²•ì˜ í˜ê³¼ ìš”ì†Œ": "í™©ê¸ˆë¹› ë¨¸ë¦¬ì¹´ë½, ì¹˜ìœ ì˜ ë…¸ë˜, ê·¸ë¦¬ê³  ê·¸ í˜ì„ ì´ìš©í•˜ë ¤ëŠ” ë¹ŒëŸ°ì˜ ëª©ì ",
            "í”Œë¦° ë¼ì´ë”ì™€ ì—¬ì •": "ì™•ê´€ ë„ë‚œ ì‚¬ê±´ê³¼ ë¼í‘¼ì ¤ê³¼ì˜ ì²« ì™¸ë¶€ ëª¨í—˜, ê·¸ë¦¬ê³  ë‘˜ì˜ ì„±ì¥ ê³¼ì •",
            "í›„ë°˜ë¶€ì™€ ì£¼ì œ": "ëœí„´ ì¶•ì œ, ë¼í‘¼ì ¤ì˜ ì •ì²´ì„±, ì˜í™”ì˜ ê²°ë§, ë‹´ê³  ìˆëŠ” ë©”ì‹œì§€"
        };
        return descriptions[categoryName] || 'í€´ì¦ˆ ë‚´ìš© ì„¤ëª…';
    }


    // --- í€´ì¦ˆ ì‹œì‘ í•¨ìˆ˜ ---
    function startQuiz(categoryName, themeId) {
        // 1. í…Œë§ˆ ì ìš©
        applyThemeToQuizScreen(themeId);
        
        // 2. ë°ì´í„° í•„í„°ë§ ë° ì´ˆê¸°í™”
        currentQuizData = QUIZ_DATA.quizzes.filter(q => q.category === categoryName);
        totalQuestions = currentQuizData.length;
        currentQuestionIndex = 0;
        score = 0; 
        
        // 3. ì œëª© ì—…ë°ì´íŠ¸ ë° ì‹¤ì‹œê°„ ì ìˆ˜íŒ ì´ˆê¸°í™”
        currentCategoryTitle.textContent = categoryName;
        currentScoreElement.textContent = score * POINTS_PER_QUESTION; 
        
        // 4. ê²Œì„ í™”ë©´ìœ¼ë¡œ ì „í™˜ ë° í€´ì¦ˆ ë Œë”ë§
        showScreen('game');
        renderQuiz();
    }

    // --- í€´ì¦ˆ ë¬¸ì œ ë Œë”ë§ í•¨ìˆ˜ ---
    function renderQuiz() {
        if (currentQuestionIndex >= totalQuestions) {
            showResultScreen();
            return;
        }

        const currentQuiz = currentQuizData[currentQuestionIndex];
        
        // ì •ë³´ ì—…ë°ì´íŠ¸
        questionTextElement.innerHTML = `Q. ${currentQuiz.question}`;
        pageNumberElement.textContent = `${currentQuestionIndex + 1}/${totalQuestions}`;
        progressBar.style.width = `${((currentQuestionIndex + 1) / totalQuestions) * 100}%`;

        // ì„ íƒì§€ ì˜ì—­ ì´ˆê¸°í™”
        choicesArea.innerHTML = '';

        for (let i = 0; i < currentQuiz.choices.length; i += 2) {
            const row = document.createElement('div');
            row.className = 'choice-row';

            const card1 = createChoiceCard(currentQuiz.choices[i], i + 1);
            row.appendChild(card1);

            if (i + 1 < currentQuiz.choices.length) {
                const card2 = createChoiceCard(currentQuiz.choices[i + 1], i + 2);
                row.appendChild(card2);
            }

            choicesArea.appendChild(row);
        }
    }
    
    // --- ê°œë³„ ì„ íƒì§€ ì¹´ë“œ ìƒì„± í•¨ìˆ˜ ---
    function createChoiceCard(choiceText, choiceIndex) {
        const card = document.createElement('div');
        card.className = 'choice-card';
        card.innerHTML = `
            <div class="checkbox"></div>
            <div class="choice-content">
                
                <p class="type-desc">${choiceText}</p>
            </div>
        `;

        card.addEventListener('click', () => handleChoiceClick(card, choiceIndex));
        return card;
    }

    // --- ì„ íƒì§€ í´ë¦­ ì²˜ë¦¬ í•¨ìˆ˜ ---
    function handleChoiceClick(clickedCard, selectedChoiceIndex) {
        const currentQuiz = currentQuizData[currentQuestionIndex];
        
        // 1. ëª¨ë“  ì¹´ë“œì˜ ìŠ¤íƒ€ì¼ì„ ì´ˆê¸°í™”
        const allChoiceCards = document.querySelectorAll('.choice-card');
        allChoiceCards.forEach(card => card.classList.remove('active-left', 'active-right'));

        // 2. ì„ íƒí•œ ì¹´ë“œì—ë§Œ ìŠ¤íƒ€ì¼ ì ìš©
        const isLeftCard = (selectedChoiceIndex % 2) !== 0; 
        clickedCard.classList.add(isLeftCard ? 'active-left' : 'active-right');

        // 3. ë‹µë³€ ì €ì¥ ë° ì¤‘ê°„ ì ìˆ˜ ê¸°ë¡ 
        userAnswers[currentQuiz.id] = selectedChoiceIndex;
        if (selectedChoiceIndex === currentQuiz.correct) {
            score++; 
            currentScoreElement.textContent = score * POINTS_PER_QUESTION;
        } 
        
        // 4. 0.8ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™
        setTimeout(() => {
            currentQuestionIndex++;
            renderQuiz();
        }, 800); 
    }
    
    // --- ê²°ê³¼ í™”ë©´ í‘œì‹œ í•¨ìˆ˜ ---
    function showResultScreen() {
        const finalCorrectCount = score; 
        const total = totalQuestions; 
        
        const finalScore = finalCorrectCount * POINTS_PER_QUESTION; 
        const percentage = (finalScore / 100) * 100;

        document.getElementById('resultTitle').textContent = "ğŸ‘‘ í€´ì¦ˆ ì¢…ë£Œ! ğŸ‘‘";
        
        finalScoreText.textContent = `${finalScore}ì `;
        
        document.getElementById('resultScore').innerHTML = `(ì´ ${total}ë¬¸ì œ ì¤‘ <strong>${finalCorrectCount}</strong> ë¬¸ì œ ì •ë‹µ)`;
        
        let message = '';
        if (percentage === 100) {
            message = "ì •ë‹µë¥  100%! ë‹¹ì‹ ì€ ë¼í‘¼ì ¤ì˜ ë§ˆë²•ì— í†µë‹¬í–ˆìŠµë‹ˆë‹¤!";
        } else if (percentage >= 80) {
            message = "í™˜ìƒì ì…ë‹ˆë‹¤! ë¼í‘¼ì ¤ì˜ ëª¨í—˜ì„ ê¹Šì´ ì´í•´í•˜ê³  ê³„ì‹œë„¤ìš”!";
        } else if (percentage >= 60) {
             message = "ì˜í•˜ì…¨ì–´ìš”! ë¼í‘¼ì ¤ì— ëŒ€í•œ ì§€ì‹ì´ ê½¤ íƒ„íƒ„í•©ë‹ˆë‹¤.";
        } else {
            message = "ë‹¤ìŒ ëª¨í—˜ì—ì„œëŠ” ë§ˆë²•ì˜ ê½ƒì„ ì°¾ì•„ ë” ì¢‹ì€ ì„±ê³¼ë¥¼ ê¸°ëŒ€í•©ë‹ˆë‹¤!";
        }
        document.getElementById('resultMessage').textContent = message;
        
        showScreen('result');
    }

    // ì´ˆê¸° ë¡œë“œ: ì¹´í…Œê³ ë¦¬ ì„ íƒ í™”ë©´ í‘œì‹œ
    document.addEventListener('DOMContentLoaded', renderCategorySelection);

    // JavaScript ì½”ë“œ ë
</script>

<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body>
</html>